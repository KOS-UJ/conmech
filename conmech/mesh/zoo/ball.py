# CONMECH @ Jagiellonian University in Krak√≥w
#
# Copyright (C) 2023  Piotr Bartman <piotr.bartman@uj.edu.pl>
#
# This program is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License
# as published by the Free Software Foundation; either version 3
# of the License, or (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301,
# USA.
import numpy as np

from conmech.mesh.zoo.raw_mesh import RawMesh
from conmech.mesh.zoo import MeshZOO
from conmech.properties.mesh_properties import GeneratedMeshProperties


@MeshZOO.register("ball", "ball_3d", "meshzoo_ball_3d")
class Ball(RawMesh):
    def __init__(self, _mesh_prop: GeneratedMeshProperties):
        nodes = np.asarray(
            [
                [-0.33333333, -0.33333333, -0.33333333],
                [-0.13245324, -0.39735971, -0.39735971],
                [0.13245324, -0.39735971, -0.39735971],
                [0.33333333, -0.33333333, -0.33333333],
                [-0.39735971, -0.13245324, -0.39735971],
                [-0.17407766, -0.17407766, -0.52223297],
                [0.17407766, -0.17407766, -0.52223297],
                [0.39735971, -0.13245324, -0.39735971],
                [-0.39735971, 0.13245324, -0.39735971],
                [-0.17407766, 0.17407766, -0.52223297],
                [0.17407766, 0.17407766, -0.52223297],
                [0.39735971, 0.13245324, -0.39735971],
                [-0.33333333, 0.33333333, -0.33333333],
                [-0.13245324, 0.39735971, -0.39735971],
                [0.13245324, 0.39735971, -0.39735971],
                [0.33333333, 0.33333333, -0.33333333],
                [-0.39735971, -0.39735971, -0.13245324],
                [-0.17407766, -0.52223297, -0.17407766],
                [0.17407766, -0.52223297, -0.17407766],
                [0.39735971, -0.39735971, -0.13245324],
                [-0.52223297, -0.17407766, -0.17407766],
                [-0.11111111, -0.11111111, -0.11111111],
                [0.11111111, -0.11111111, -0.11111111],
                [0.52223297, -0.17407766, -0.17407766],
                [-0.52223297, 0.17407766, -0.17407766],
                [-0.11111111, 0.11111111, -0.11111111],
                [0.11111111, 0.11111111, -0.11111111],
                [0.52223297, 0.17407766, -0.17407766],
                [-0.39735971, 0.39735971, -0.13245324],
                [-0.17407766, 0.52223297, -0.17407766],
                [0.17407766, 0.52223297, -0.17407766],
                [0.39735971, 0.39735971, -0.13245324],
                [-0.39735971, -0.39735971, 0.13245324],
                [-0.17407766, -0.52223297, 0.17407766],
                [0.17407766, -0.52223297, 0.17407766],
                [0.39735971, -0.39735971, 0.13245324],
                [-0.52223297, -0.17407766, 0.17407766],
                [-0.11111111, -0.11111111, 0.11111111],
                [0.11111111, -0.11111111, 0.11111111],
                [0.52223297, -0.17407766, 0.17407766],
                [-0.52223297, 0.17407766, 0.17407766],
                [-0.11111111, 0.11111111, 0.11111111],
                [0.11111111, 0.11111111, 0.11111111],
                [0.52223297, 0.17407766, 0.17407766],
                [-0.39735971, 0.39735971, 0.13245324],
                [-0.17407766, 0.52223297, 0.17407766],
                [0.17407766, 0.52223297, 0.17407766],
                [0.39735971, 0.39735971, 0.13245324],
                [-0.33333333, -0.33333333, 0.33333333],
                [-0.13245324, -0.39735971, 0.39735971],
                [0.13245324, -0.39735971, 0.39735971],
                [0.33333333, -0.33333333, 0.33333333],
                [-0.39735971, -0.13245324, 0.39735971],
                [-0.17407766, -0.17407766, 0.52223297],
                [0.17407766, -0.17407766, 0.52223297],
                [0.39735971, -0.13245324, 0.39735971],
                [-0.39735971, 0.13245324, 0.39735971],
                [-0.17407766, 0.17407766, 0.52223297],
                [0.17407766, 0.17407766, 0.52223297],
                [0.39735971, 0.13245324, 0.39735971],
                [-0.33333333, 0.33333333, 0.33333333],
                [-0.13245324, 0.39735971, 0.39735971],
                [0.13245324, 0.39735971, 0.39735971],
                [0.33333333, 0.33333333, 0.33333333],
            ]
        )
        elements = np.asarray(
            [
                [0, 1, 4, 16],
                [32, 33, 36, 48],
                [20, 21, 24, 36],
                [8, 9, 12, 24],
                [40, 41, 44, 56],
                [17, 18, 21, 33],
                [5, 6, 9, 21],
                [37, 38, 41, 53],
                [25, 26, 29, 41],
                [2, 3, 6, 18],
                [34, 35, 38, 50],
                [22, 23, 26, 38],
                [10, 11, 14, 26],
                [42, 43, 46, 58],
                [1, 5, 4, 21],
                [33, 37, 36, 53],
                [21, 25, 24, 41],
                [9, 13, 12, 29],
                [41, 45, 44, 61],
                [18, 22, 21, 38],
                [6, 10, 9, 26],
                [38, 42, 41, 58],
                [26, 30, 29, 46],
                [3, 7, 6, 23],
                [35, 39, 38, 55],
                [23, 27, 26, 43],
                [11, 15, 14, 31],
                [43, 47, 46, 63],
                [1, 4, 16, 21],
                [33, 36, 48, 53],
                [21, 24, 36, 41],
                [9, 12, 24, 29],
                [41, 44, 56, 61],
                [18, 21, 33, 38],
                [6, 9, 21, 26],
                [38, 41, 53, 58],
                [26, 29, 41, 46],
                [3, 6, 18, 23],
                [35, 38, 50, 55],
                [23, 26, 38, 43],
                [11, 14, 26, 31],
                [43, 46, 58, 63],
                [1, 16, 17, 21],
                [33, 48, 49, 53],
                [21, 36, 37, 41],
                [9, 24, 25, 29],
                [41, 56, 57, 61],
                [18, 33, 34, 38],
                [6, 21, 22, 26],
                [38, 53, 54, 58],
                [26, 41, 42, 46],
                [3, 18, 19, 23],
                [35, 50, 51, 55],
                [23, 38, 39, 43],
                [11, 26, 27, 31],
                [43, 58, 59, 63],
                [4, 16, 21, 20],
                [36, 48, 53, 52],
                [24, 36, 41, 40],
                [12, 24, 29, 28],
                [44, 56, 61, 60],
                [21, 33, 38, 37],
                [9, 21, 26, 25],
                [41, 53, 58, 57],
                [29, 41, 46, 45],
                [6, 18, 23, 22],
                [38, 50, 55, 54],
                [26, 38, 43, 42],
                [14, 26, 31, 30],
                [46, 58, 63, 62],
                [32, 33, 16, 36],
                [20, 21, 4, 24],
                [52, 53, 36, 56],
                [40, 41, 24, 44],
                [17, 18, 1, 21],
                [49, 50, 33, 53],
                [37, 38, 21, 41],
                [25, 26, 9, 29],
                [57, 58, 41, 61],
                [34, 35, 18, 38],
                [22, 23, 6, 26],
                [54, 55, 38, 58],
                [42, 43, 26, 46],
                [33, 37, 21, 36],
                [21, 25, 9, 24],
                [53, 57, 41, 56],
                [41, 45, 29, 44],
                [18, 22, 6, 21],
                [50, 54, 38, 53],
                [38, 42, 26, 41],
                [26, 30, 14, 29],
                [58, 62, 46, 61],
                [35, 39, 23, 38],
                [23, 27, 11, 26],
                [55, 59, 43, 58],
                [43, 47, 31, 46],
                [33, 36, 21, 16],
                [21, 24, 9, 4],
                [53, 56, 41, 36],
                [41, 44, 29, 24],
                [18, 21, 6, 1],
                [50, 53, 38, 33],
                [38, 41, 26, 21],
                [26, 29, 14, 9],
                [58, 61, 46, 41],
                [35, 38, 23, 18],
                [23, 26, 11, 6],
                [55, 58, 43, 38],
                [43, 46, 31, 26],
                [33, 16, 21, 17],
                [21, 4, 9, 5],
                [53, 36, 41, 37],
                [41, 24, 29, 25],
                [18, 1, 6, 2],
                [50, 33, 38, 34],
                [38, 21, 26, 22],
                [26, 9, 14, 10],
                [58, 41, 46, 42],
                [35, 18, 23, 19],
                [23, 6, 11, 7],
                [55, 38, 43, 39],
                [43, 26, 31, 27],
                [36, 16, 20, 21],
                [24, 4, 8, 9],
                [56, 36, 40, 41],
                [44, 24, 28, 29],
                [21, 1, 5, 6],
                [53, 33, 37, 38],
                [41, 21, 25, 26],
                [29, 9, 13, 14],
                [61, 41, 45, 46],
                [38, 18, 22, 23],
                [26, 6, 10, 11],
                [58, 38, 42, 43],
                [46, 26, 30, 31],
            ]
        )

        super().__init__(nodes, elements)
